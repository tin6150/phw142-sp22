---
title: "Homework 5: Normal and Binomial Distributions"
author: "Your name and student ID"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output: pdf_document
---


**Run this chunk of code to load the autograder package!**
```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(testthat)
```

### Instructions 
* Solutions will be released on Tuesday, March 1st.
* This semester, homework assignments are for practice only and will not be turned in for marks.

Helpful hints:

- Every function you need to use was taught during lecture! So you may need to revisit the lecture code to help you along by opening the relevant files on Datahub. Alternatively, you may wish to view the code in the condensed PDFs posted on the course website. Good luck!

- Knit your file early and often to minimize knitting errors! If you copy and paste code for the slides, you are bound to get an error that is hard to  diagnose. Typing out the code is the way to smooth knitting! We recommend knitting your file each time after you write a few sentences/add a new code chunk, so you can detect the source of knitting errors more easily. This will save you and the GSIs from frustration! **You must knit correctly before submitting.**

- To avoid code running off the page, have a look at your knitted PDF and ensure all the code fits in the file. If it doesn't look right, go back to your .Rmd file and add spaces (new lines) using the return or enter key so that the code runs onto the next line.

\newpage

--------------------------------------------------------------------------------

## Part 1: Pregnancy Length Probabilities

An average pregnancy for humans lasts 266 days, with a standard deviation of 
16 days. Assume that human pregnancies are Normally distributed. 

**1. [1 point] Approximately what proportion of births are expected to occur on or before 298 days? To aid your answer, hand-draw (or use any software to sketch) a Normal curve and add dashed lines at the mean +/- 1SD, 2SD and 3SD. Calculate the proportion of births occurring on or before 298 days by shading this region under the curve. You shouldn't need to use R to perform any calculations for this question. Round the proportion to one decimal place.**

(Use the code chunk below to include an image file of your drawing. To do this you need to delete the hashtag, upload the image to Datahub into the `src` directory and replace the file name with your file name. JPG or PNG will both work).

```{r, out.width="50%"}
#knitr::include_graphics("src/Your-file-name.JPG")

```

_Type your answer here, replacing this text._

\newpage

**2. [1 point] Check your answer from part a) using R code. Create a vector called `p2` that stores 2 values: your answer from part a and the absolute difference between your answer from a and the exact probability that you calculated with code.**

```{r}
p2 <- NULL # YOUR CODE HERE
p2


me = .975
pn = pnorm(q=298,mean=266,sd=16)

delta = abs(me - pn)
p2 = c(pn, delta)

#p2 = c(me, 0.01)
#p2 = pn
p2


# YOUR CODE HERE
```

```{r}
. = ottr::check("tests/p2.R")
```

\newpage

**3. [1 point] What is the range, in days, that the middle 50% of pregnancies last? To aid your answer, hand-draw (or use any software to sketch) a Normal curve and shade in the area that the middle range represents. Then use R to calculate this middle range. Round the lower and upper bound of the range each to two decimal places.**

(Use the code chunk below to include an image file of your drawing. To do so you need to delete the hashtag, upload the image to Datahub into the `src` directory and replace the file name with your file name. JPG or PNG will both work).

```{r}
#knitr::include_graphics("src/Your-file-name.JPG")
```

```{r, out.width="50%"}
# YOUR CODE HERE

# oh, 50% are not 1sd away from mean... 
left = qnorm(p=.25,mean=266,sd=16)
right = qnorm(p=.75,mean=266,sd=16)

c(left,right)

# YOUR CODE HERE
```

_50% of the prenancies will have gestation of 255 to 277 days_

\newpage

## Part 2: Assessing Normality and Interpreting QQ Plots 

The number of trees for nine plots of land, each of 0.1 hectare, have been recorded. They are: 18, 4, 22, 15, 18, 19, 22, 12, 12. Are these data Normally distributed?

\newpage

**4. [1 point] Make a Normal quantile plot for these data using R. Remember, to make a ggplot of these data, you need to first input the data as a vector and then convert that vector to a dataframe. Example code has been provided to help get you started. After making the plot, assess whether the data appear to approximately follow a Normal distribution.**

```{r ggplot_qqplot,message=FALSE}
library(tidyverse)

# example code
counts <- c(18, 4, 22, 15, 18, 19, 22, 12, 12)
tree_data <- data.frame(counts)

# YOUR CODE HERE
counts <- c(18, 4, 22, 15, 18, 19, 22, 12, 12)
tree_data <- data.frame(counts)
#View(tree_data)

ggplot(tree_data, aes(sample=counts)) + stat_qq() + stat_qq_line()

# YOUR CODE HERE
```

_yeah, the points are close enough to the qq plot line that they seems reasonably close to Normal dist_

\newpage


## Part 3: Conducting a study about general anxiety disorder

Suppose that a new treatment for general anxiety disorder has undergone safety and efficacy trials and, based on these data, 30% of patients with general anxiety disorder are expected to benefit from the new treatment. You are conducting a follow-up study and have enrolled 8 participants with general anxiety disorder so far. These patients do not know each other and represent individuals who responded to a call for study participants that 
they saw on a flier on campus.

\newpage

**5. [1 point] Let $X$ represent the number of enrolled patients who benefit from the treatment. Does $X$ meet the assumptions of a Binomial distribution? Thoroughly explain why or why not.**

_yes, X would meet the assumptions of the Binomial Distributions.  Each patient would be rated as 1/Success when they benefit from the new treament, 0/Fail otherwise, and they would be mutually exclusive and exhaustive.  There is a max number of people involved, so Poisson would not be a good distribution for this setting.  Patients and outcome are independent._

\newpage

**6. [1 point] Using one of the distributions whose assumptions $X$ meets, calculate the probability that exactly 5 participants will benefit from the treatment (by hand). Show your work.**

```{r}
p6 <- NULL # YOUR CODE HERE
n = 8
k = 5
p = 0.30
p6 = choose(n,k)*(p^k)*((1-p)^(n-k))
p6


# YOUR CODE HERE
```

```{r}
. = ottr::check("tests/p6.R")
```

\newpage

**7. [1 point] Confirm your previous calculation using an R function and store your answer to `p7`.**

```{r}
p7 <- NULL # YOUR CODE HERE
p7 = dbinom(x=5,size=8,prob=0.30)
p7


# YOUR CODE HERE
```

```{r}
. = ottr::check("tests/p7.R")
```

\newpage

**8. [1 point] Calculate the probability that 6 or more participants will benefit from the treatment (by hand). Show your work.**

6 or more participants...
can use cumulaive... 
P(X>=6)
by hand?!?!
would need to calc 
Sum( P(X=6) + P(X=7) + P(x=8))



```{r}
p8 <- NULL # YOUR CODE HERE
p8

n = 8
p = 0.30


p8 = (
  choose(n,6)*(p^6)*((1-p)^(n-6)) +
  choose(n,7)*(p^7)*((1-p)^(n-7)) +
  choose(n,8)*(p^8)*((1-p)^(n-8)) 
)

p8


# YOUR CODE HERE
```

```{r}
. = ottr::check("tests/p8.R")
```

\newpage

**9. [1 point] Confirm your previous calculation using the function `pbinom()` and store your answer to `p9`.**

```{r}
p9 <- NULL # YOUR CODE HERE
p9 = 1 - pbinom(q=6-1,size=8,prob=0.3)
p9


# YOUR CODE HERE
```

```{r}
. = ottr::check("tests/p9.R")
```

\newpage

**10. [1 point] Re-confirm your previous calculation, this time using the function `dbinom()`, and store your answer to `p10`.**

```{r}
p10 <- NULL # YOUR CODE HERE
p10 = dbinom(x=6,size=8,prob=0.3) + 
      dbinom(x=7,size=8,prob=0.3) + 
      dbinom(x=8,size=8,prob=0.3) 
p10


# YOUR CODE HERE
```

```{r}
. = ottr::check("tests/p10.R")
```

\newpage

**11. [1 point] Interpret the binomial coefficient, ${8 \choose 7}$, in the context of this study. Write out all the possible combinations to achieve ${8 \choose 7}$.**

_"8 choose 7" means that we have 8 participants, and we are looking for the chance that exactly 7 participants will benefit from the new treatment.  Using the Binomial distribution, 
P(X=7) would be one way to provide the answer.  
additionally, since pascal triangle and the combination function "n choose k" is symetrical, 
we can also calcuate using  8-7 = 1, thus
P(X=1)
_

**12. [1 point] Calculate the number of patients you would expect to benefit from the treatment. Then calculate the standard deviation of this estimate. Write a sentence to interpret the mean. If the mean is not a whole number, what whole number is most probable?**


#### this has to do with sampling dist of a count?   see L15 slide 49.

#### actually: Binomial mean and std dev, L16, slide 16!

_mu = n*p = 8 * 0.30 = 2.4, ie, about 2 person is expected to benefit from this new treatment, given the n=8 number of participants. _




\newpage

**13. [1 point] Should you apply a Normal approximation to these data using the $\mu$ and $\sigma$ you calculated in the last question? Why or why not?**



_Binom approaches N() for large n, but here n is quite small, only 8.  it would also converge to N() quicker when p is closer to 0.5, but here it is only 0.3.  n*p is 8*0.3 = 2.4, again another metrics expecting it to be > 10 for N() approx to be good.  Thus, overall, not really good to use N() approx in this case_

## END 

